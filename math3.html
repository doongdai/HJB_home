<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ì‘í’ˆ6 - ìˆ˜ë†€ì´3 (ë¬¶ì–´ì„¸ê¸° & ê³±ì…ˆ)</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh; /* í™”ë©´ ë†’ì´ë§Œí¼ */
            flex-direction: column;
            font-family: 'Comic Sans MS', sans-serif;
            margin: 0;
            padding: 0;
            position: relative;
            overflow: hidden; /* ìŠ¤í¬ë¡¤ë°” ì œê±° */
        }

        .bg-overlay {
            background-image: url('images/rocket.png'); /* ì´ë¯¸ì§€ ê²½ë¡œ í™•ì¸ */
            background-size: cover;
            background-position: center;
            opacity: 0.8;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        body * {
            color: red; /* ê¸°ë³¸ ê¸€ììƒ‰, í•„ìš”ì— ë”°ë¼ ê°œë³„ ìš”ì†Œì— ì„¤ì • */
        }

        /* ë©”ì¸ í€´ì¦ˆ ì˜ì—­ ìŠ¤íƒ€ì¼ */
        .quiz-area {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 40px;
            border-radius: 30px;
            display: inline-block;
            text-align: center; /* ë‚´ë¶€ ìš”ì†Œë“¤ì„ ì¤‘ì•™ ì •ë ¬ */
            box-shadow: 0 8px 16px rgba(0,0,0,0.2); /* ê·¸ë¦¼ì íš¨ê³¼ */
            max-width: 90%; /* ëª¨ë°”ì¼ì—ì„œë„ ì˜ ë³´ì´ë„ë¡ ìµœëŒ€ ë„ˆë¹„ ì„¤ì • */
            margin-top: 50px; /* íŒì—…ì°½ ìœ„ì¹˜ë¥¼ ê³ ë ¤í•œ ìƒë‹¨ ì—¬ë°± */
        }

        h2, h3 {
            color: blue; /* ì œëª© ìƒ‰ìƒ ì¡°ì • */
            margin-bottom: 20px;
        }

        label, input {
            font-size: 2rem;
            margin: 10px;
            display: block; /* ê° ë ˆì´ë¸”ê³¼ ì…ë ¥ì¹¸ì„ ì„¸ë¡œë¡œ ì •ë ¬ */
            text-align: left; /* í…ìŠ¤íŠ¸ ì •ë ¬ */
            width: fit-content; /* ë‚´ìš©ì— ë§ì¶° ë„ˆë¹„ ì¡°ì ˆ */
            margin-left: auto; /* ì¤‘ì•™ ì •ë ¬ */
            margin-right: auto; /* ì¤‘ì•™ ì •ë ¬ */
        }

        input[type="number"], input[type="text"] {
            width: 150px; /* ë„ˆë¹„ ì¡°ì • */
            height: 60px;
            font-size: 2rem;
            text-align: center;
            border-radius: 12px;
            border: 3px solid #888;
            padding: 0 10px; /* ë‚´ë¶€ ì—¬ë°± */
        }
        
        .equation-input {
            width: 250px; /* ê³±ì…ˆì‹ ì…ë ¥ì— í•„ìš”í•œ ë„ˆë¹„ */
            text-align: left; /* í…ìŠ¤íŠ¸ ì •ë ¬ */
            padding-left: 10px;
        }

        button {
            font-size: 2rem;
            padding: 15px 30px;
            margin: 10px;
            border: none;
            border-radius: 15px;
            background-color: blue;
            color: white;
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* ë²„íŠ¼ ê·¸ë¦¼ì */
        }

        button:hover {
            background-color: #ff7f00;
            transform: scale(1.05);
        }
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none; /* ë¹„í™œì„±í™” ì‹œ í˜¸ë²„ íš¨ê³¼ ì œê±° */
            box-shadow: none;
        }

        #result {
            font-size: 2.2rem;
            font-weight: bold;
            color: navy;
            margin-top: 20px;
            padding: 10px;
            background-color: #e0f7fa; /* ê²°ê³¼ì°½ ë°°ê²½ìƒ‰ */
            border-radius: 10px;
        }

        /* íŒì—…ì°½ ê³µí†µ ìŠ¤íƒ€ì¼ */
        .popup-overlay {
            display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7); /* ì–´ë‘ìš´ ë°°ê²½ */
            z-index: 1000;
            pointer-events: auto; /* íŒì—… ì˜¤ë²„ë ˆì´ ìì²´ëŠ” í´ë¦­ì— ë°˜ì‘í•˜ë„ë¡ */
        }

        .popup-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px; /* íŒì—… ìµœëŒ€ ë„ˆë¹„ */
            max-height: 90vh; /* íŒì—… ìµœëŒ€ ë†’ì´ (ë·°í¬íŠ¸ ë†’ì´ì˜ 90%) */
            overflow-y: auto; /* ë‚´ìš©ì´ ë§ìœ¼ë©´ ìŠ¤í¬ë¡¤ */
            position: absolute; /* ì ˆëŒ€ ìœ„ì¹˜ ì‚¬ìš© */
            top: 20px; /* ìœ„ì—ì„œ 20px ë–¨ì–´ì§„ ìœ„ì¹˜ */
            right: 20px; /* ì˜¤ë¥¸ìª½ì—ì„œ 20px ë–¨ì–´ì§„ ìœ„ì¹˜ */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3); /* ê·¸ë¦¼ì ì¶”ê°€ë¡œ ì…ì²´ê° ë¶€ì—¬ */
            display: flex; /* ë‚´ë¶€ ìš”ì†Œ ì •ë ¬ì„ ìœ„í•´ flex ì‚¬ìš© */
            flex-direction: column; /* ì„¸ë¡œ ì •ë ¬ */
            justify-content: space-between; /* ë‚´ìš©ê³¼ ë²„íŠ¼ì„ ìœ„ì•„ë˜ë¡œ ë¶„ë¦¬ */
            align-items: center; /* ê°€ìš´ë° ì •ë ¬ */
            gap: 15px; /* ë‚´ë¶€ ìš”ì†Œë“¤ ì‚¬ì´ì˜ ê°„ê²© */
            pointer-events: auto; /* íŒì—… ì½˜í…ì¸  ìì²´ëŠ” í´ë¦­ì— ë°˜ì‘í•´ì•¼ í•˜ë¯€ë¡œ autoë¡œ ì„¤ì • */
        }
        /* ëª¨ë°”ì¼ í™˜ê²½ì—ì„œ íŒì—…ì°½ ìœ„ì¹˜ ì¡°ì • */
        @media (max-width: 600px) {
            .popup-content {
                top: 10px;
                right: 10px;
                left: 10px; /* ëª¨ë°”ì¼ì—ì„œëŠ” ë„ˆë¹„ë¥¼ ê½‰ ì±„ìš°ë„ë¡ */
                max-width: none; /* ëª¨ë°”ì¼ì—ì„œëŠ” ìµœëŒ€ ë„ˆë¹„ ì œí•œ í•´ì œ */
                padding: 20px;
            }
        }


        /* íŒì—…ì°½ ë‹«ê¸° X ë²„íŠ¼ */
        .close-x-button {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 1.5rem;
            cursor: pointer;
            color: #555;
            background: none;
            border: none;
            padding: 0;
            margin: 0;
            transition: color 0.2s, transform 0.2s;
        }
        .close-x-button:hover {
            color: #f00;
            transform: scale(1.1);
        }

        /* íŒì—…ì°½ í•˜ë‹¨ ë‹«ê¸° ë²„íŠ¼ */
        .close-button-bottom {
            font-size: 1.5rem; /* í°íŠ¸ í¬ê¸° ì¡°ì • */
            padding: 10px 20px;
            margin-top: 20px;
            background-color: #f44336; /* ë¹¨ê°„ìƒ‰ ê³„ì—´ */
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
        }
        .close-button-bottom:hover {
            background-color: #d32f2f;
            transform: scale(1.05);
        }

        /* ë¬¶ì–´ ì„¸ê¸° ì„ íƒ íŒì—… ë‚´ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .grouping-button {
            font-size: 1.5rem;
            padding: 12px 25px;
            margin: 8px; /* ë²„íŠ¼ ê°„ ê°„ê²© */
            border: none;
            border-radius: 12px;
            background-color: #6a5acd; /* ë³´ë¼ìƒ‰ ê³„ì—´ */
            color: white;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
            flex: 1 1 auto; /* ë‚´ìš©ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ í¬ê¸° ì¡°ì ˆ */
            min-width: 120px; /* ìµœì†Œ ë„ˆë¹„ */
            max-width: 200px; /* ìµœëŒ€ ë„ˆë¹„ */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .grouping-button:hover {
            background-color: #483d8b;
            transform: scale(1.05);
        }

        /* íŒì—…ì°½ ë‚´ ì´ë¯¸ì§€ ì»¨í…Œì´ë„ˆ (ë¬¶ìŒ ì •ë ¬) */
        #imageContainer {
            display: flex;
            flex-wrap: wrap; /* ì´ë¯¸ì§€ê°€ ë„˜ì¹˜ë©´ ë‹¤ìŒ ì¤„ë¡œ */
            justify-content: center; /* ë¬¶ìŒë“¤ì„ ì¤‘ì•™ ì •ë ¬ */
            align-items: flex-start; /* ë¬¶ìŒë“¤ì´ ìœ„ì—ì„œë¶€í„° ì •ë ¬ */
            gap: 10px; /* ë¬¶ìŒ div ê°„ì˜ ê°„ê²© */
            padding: 10px;
            max-width: 100%; /* íŒì—… ë‚´ìš© ë„ˆë¹„ì— ë§ì¶° ì¡°ì ˆ */
            overflow-y: auto; /* ë‚´ìš© ë§ìœ¼ë©´ ìŠ¤í¬ë¡¤ */
        }

        /* ê°œë³„ ë¬¶ìŒ(div) ìŠ¤íƒ€ì¼ */
        .image-group {
            display: flex; /* ë¬¶ìŒ ë‚´ ì´ë¯¸ì§€ë“¤ì„ ê°€ë¡œë¡œ ì •ë ¬ */
            flex-wrap: wrap; /* í•œ ë¬¶ìŒ ë‚´ì—ì„œë„ ë„˜ì¹˜ë©´ ë‹¤ìŒ ì¤„ë¡œ */
            justify-content: center;
            align-items: center;
            border: 1px dashed #ccc; /* ë¬¶ìŒ êµ¬ë¶„ì„  */
            padding: 5px;
            border-radius: 8px;
            background-color: #f9f9f9;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            min-width: 80px; /* ë¬¶ìŒ divì˜ ìµœì†Œ ë„ˆë¹„ */
            max-width: calc(100% / 3 - 20px); /* í•œ ì¤„ì— 3ê°œ ì •ë„ ë³´ì´ë„ë¡ (ëŒ€ëµ) */
            box-sizing: border-box; /* íŒ¨ë”©, ë³´ë”ê°€ ë„ˆë¹„ì— í¬í•¨ë˜ë„ë¡ */
        }
        /* ì´ë¯¸ì§€ í¬ê¸° ì¡°ì ˆ */
        .image-group img {
            width: 100%; /* ë¬¶ìŒ div ì•ˆì— ê½‰ ì°¨ë„ë¡ */
            height: auto; /* ë¹„ìœ¨ ìœ ì§€ */
            max-width: 100px; /* ìµœëŒ€ í¬ê¸° ì„¤ì • (ë¬¶ìŒ ì´ë¯¸ì§€ ìì²´ê°€ í´ ê²½ìš°) */
            max-height: 100px; /* ìµœëŒ€ í¬ê¸° ì„¤ì • */
            margin: 0; /* ì´ë¯¸ì§€ ê°„ ê°„ê²© ì—†ìŒ (ë¬¶ìŒ ì´ë¯¸ì§€ëŠ” í•˜ë‚˜ë§Œ ë“¤ì–´ê°€ë¯€ë¡œ) */
            object-fit: contain;

        /* 0ê°œì¼ ë•Œ í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .zero-text {
            font-size: 2rem;
            color: blue;
            font-weight: bold;
            margin: 20px;
        }
    </style>
</head>
<body>
    <div class="bg-overlay"></div>
    <div class="quiz-area">
        <h2>ğŸ¨ ì‘í’ˆ6 (1ê°œì”© ë¬¶ì–´ ì„¸ê¸° ë¶€í„° 9ê°œì”© ë¬¶ì–´ ì„¸ê¸°ê¹Œì§€)</h2>

        <h3>ğŸ”¢ ê³±ì…ˆ êµ¬êµ¬ë‹¨ ì—°ìŠµ</h3>
        <p>ë¬¶ì–´ ì„¸ê¸° ë‹¨ìœ„ë¥¼ ì„ íƒí•˜ê³  ê·¸ë¦¼ì„ í™•ì¸í•œ í›„ ê°œìˆ˜ì™€ ê³±ì…ˆì‹ì„ ì…ë ¥í•´ ë³´ì„¸ìš”.</p>

        <!-- ë¬¶ì–´ ì„¸ê¸° ë‹¨ìœ„ ì„ íƒ ë²„íŠ¼ -->
        <button onclick="showGroupingOptionPopup()">ë¬¶ì–´ ì„¸ê¸° ì„ íƒ</button>
        <br>

        <!-- ì‹œì‘ ë²„íŠ¼: ë¬¶ìŒ ê·¸ë¦¼ íŒì—… ì—´ê¸° -->
        <button id="startButton" onclick="showCountingPopup()" disabled>ì‹œì‘</button>
        <br>

        <!-- ì´ ê°œìˆ˜ ì…ë ¥ í•„ë“œ -->
        <label id="totalCountLabel" style="display:none;">ì´ ëª‡ ê°œì¼ê¹Œìš”?: <input type="number" id="totalCountAnswer" min="0" max="81"></label><br>
        
        <!-- ê³±ì…ˆì‹ ì…ë ¥ í•„ë“œ -->
        <label id="equationLabel" style="display:none;">ê³±ì…ˆì‹ì€? (ì˜ˆ: 1x7=7): <input type="text" id="equationAnswer" class="equation-input"></label><br>
        
        <button onclick="checkAnswer()">ê²°ê³¼ í™•ì¸</button>
        <button onclick="resetQuiz()">ì²˜ìŒìœ¼ë¡œ</button>

        <p id="result" style="font-weight: bold; color: navy;"></p>

        <audio id="correctSound" src="sounds/correct.mp3"></audio>
        <audio id="wrongSound" src="sounds/wrong.mp3"></audio>
    </div>

<!-- ë¬¶ì–´ ì„¸ê¸° ë‹¨ìœ„ ì„ íƒ íŒì—…ì°½ -->
<div class="popup-overlay" id="groupingOptionPopupOverlay">
    <div class="popup-content">
        <button class="close-x-button" onclick="hideGroupingOptionPopup()">&times;</button>
        <p style="font-size: 2.5rem; color: #333; font-weight: bold;">ëª‡ ê°œì”© ë¬¶ì–´ ì„¸ê¸°ë¥¼ í• ê¹Œìš”?</p>
        <div id="groupingButtonsContainer" style="display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 10px;">
            <!-- JavaScriptë¡œ ë¬¶ì–´ ì„¸ê¸° ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ì‚½ì…ë©ë‹ˆë‹¤ -->
        </div>
        <button class="close-button-bottom" onclick="hideGroupingOptionPopup()">ë‹«ê¸°</button>
    </div>
</div>

<!-- ê·¸ë¦¼ì„ ë³´ì—¬ì£¼ëŠ” íŒì—…ì°½ -->
<div class="popup-overlay" id="countingPopupOverlay">
    <div class="popup-content">
        <button class="close-x-button" onclick="hideCountingPopup()">&times;</button>
        <p style="font-size: 2.5rem; color: #333; font-weight: bold;">ëª‡ ê°œì¸ì§€ ì„¸ì–´ë³´ì„¸ìš”!</p>
        <div id="imageContainer">
            <!-- JavaScriptë¡œ ì´ë¯¸ì§€ê°€ ì—¬ê¸°ì— ì‚½ì…ë©ë‹ˆë‹¤ -->
        </div>
        <button class="close-button-bottom" onclick="hideCountingPopup()">ì°½ ë‹«ê¸°</button>
    </div>
</div>

<script>
// ì „ì—­ ë³€ìˆ˜
let groupingUnit = 0; // ì„ íƒëœ ë¬¶ì–´ ì„¸ê¸° ë‹¨ìœ„ (1~9)
let numberOfGroups = 0; // ëœë¤ìœ¼ë¡œ ìƒì„±ëœ ë¬¶ìŒì˜ ê°œìˆ˜ (0~9)
let correctTotalCount = 0; // ì´ ê°œìˆ˜ (ë¬¶ì–´ ì„¸ê¸° ë‹¨ìœ„ * ë¬¶ìŒ ê°œìˆ˜)

// DOM ìš”ì†Œ ì°¸ì¡° (ë³€ìˆ˜ë¡œ ì €ì¥í•˜ì—¬ íš¨ìœ¨ì„± ë†’ì„)
const startButton = document.getElementById("startButton");
const totalCountLabel = document.getElementById("totalCountLabel");
const totalCountAnswerInput = document.getElementById("totalCountAnswer");
const equationLabel = document.getElementById("equationLabel");
const equationAnswerInput = document.getElementById("equationAnswer");
const resultDisplay = document.getElementById("result");
const correctSound = document.getElementById("correctSound");
const wrongSound = document.getElementById("wrongSound");

// íŒì—… ì˜¤ë²„ë ˆì´
const groupingOptionPopupOverlay = document.getElementById("groupingOptionPopupOverlay");
const countingPopupOverlay = document.getElementById("countingPopupOverlay");
const groupingButtonsContainer = document.getElementById("groupingButtonsContainer");
const imageContainer = document.getElementById("imageContainer");


// 1. ë¬¶ì–´ ì„¸ê¸° ì„ íƒ íŒì—…ì°½ ì—´ê¸°
function showGroupingOptionPopup() {
    groupingButtonsContainer.innerHTML = ''; // ì´ì „ ë²„íŠ¼ë“¤ ì´ˆê¸°í™”

    // 1ê°œì”© ë¬¶ì–´ ì„¸ê¸°ë¶€í„° 9ê°œì”© ë¬¶ì–´ ì„¸ê¸°ê¹Œì§€ ë²„íŠ¼ ìƒì„±
    for (let i = 1; i <= 9; i++) {
        const button = document.createElement('button');
        button.innerText = `${i}ê°œì”© ë¬¶ì–´ ì„¸ê¸°`;
        button.className = 'grouping-button';
        button.onclick = () => selectGroupingUnit(i); // í´ë¦­ ì‹œ ë‹¨ìœ„ ì„ íƒ í•¨ìˆ˜ í˜¸ì¶œ
        groupingButtonsContainer.appendChild(button);
    }

    groupingOptionPopupOverlay.style.display = 'flex'; // íŒì—…ì°½ í‘œì‹œ

    // ì‹œì‘ ë²„íŠ¼, ì…ë ¥ í•„ë“œ ë° ê²°ê³¼ ì´ˆê¸°í™”/ìˆ¨ê¹€
    startButton.disabled = true;
    totalCountLabel.style.display = 'none';
    totalCountAnswerInput.style.display = 'none';
    equationLabel.style.display = 'none';
    equationAnswerInput.style.display = 'none';
    resultDisplay.innerText = "";
}

// 2. ë¬¶ì–´ ì„¸ê¸° ë‹¨ìœ„ ì„ íƒ í•¨ìˆ˜
function selectGroupingUnit(unit) {
    groupingUnit = unit; // ì„ íƒëœ ë‹¨ìœ„ë¥¼ ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
    hideGroupingOptionPopup(); // íŒì—…ì°½ ë‹«ê¸°
    startButton.disabled = false; // ì‹œì‘ ë²„íŠ¼ í™œì„±í™”
    alert(`${groupingUnit}ê°œì”© ë¬¶ì–´ ì„¸ê¸°ë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤. ì´ì œ 'ì‹œì‘' ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”!`); // ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼
    resetInputsAndResult(); // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™” ë° ìˆ¨ê¸°ê¸°
}

// 3. ë¬¶ì–´ ì„¸ê¸° ì„ íƒ íŒì—…ì°½ ë‹«ê¸°
function hideGroupingOptionPopup() {
    groupingOptionPopupOverlay.style.display = 'none';
}


// 4. ê·¸ë¦¼ì„ ë³´ì—¬ì£¼ëŠ” íŒì—…ì°½ ì—´ê¸° (showCountingPopup í•¨ìˆ˜ ìˆ˜ì •)
function showCountingPopup() {
    if (groupingUnit === 0) {
        alert("ë¨¼ì € 'ë¬¶ì–´ ì„¸ê¸° ì„ íƒ' ë²„íŠ¼ì„ ëˆŒëŸ¬ ë¬¶ì–´ ì„¸ê¸° ë‹¨ìœ„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!");
        return;
    }

    imageContainer.innerHTML = ''; // ì´ì „ ì´ë¯¸ì§€ë“¤ ì´ˆê¸°í™”

    // 0~9 ë¬¶ìŒ ì¤‘ ëœë¤ìœ¼ë¡œ ë¬¶ìŒ ê°œìˆ˜ ìƒì„±
    // ë¬¶ìŒ ê°œìˆ˜ê°€ 0ì¸ ê²½ìš°ë„ í—ˆìš©í•©ë‹ˆë‹¤. (0ê°œë¶€í„° 9ê°œ ë¬¶ìŒê¹Œì§€)
    numberOfGroups = Math.floor(Math.random() * 10); 
    correctTotalCount = groupingUnit * numberOfGroups; // ì‹¤ì œ ì´ ê°œìˆ˜

    // ë¬¶ì–´ ì„¸ê¸° ë‹¨ìœ„ì— í•´ë‹¹í•˜ëŠ” ê³¼ì¼ ì´ë¯¸ì§€ ê²½ë¡œ ì„¤ì •
    let imageFileName = `fruit${groupingUnit}`;
    let imageExtension = '.png';
    // fruit2ì™€ fruit4ëŠ” .jpg í˜•ì‹
    if (groupingUnit === 2 || groupingUnit === 4) {
        imageExtension = '.jpg';
    }
    const imagePath = `images/${imageFileName}${imageExtension}`;
    

    // ë¬¶ìŒ ë‹¨ìœ„ë¡œ ì´ë¯¸ì§€ í‘œì‹œ
    if (numberOfGroups === 0) {
        // ë¬¶ìŒ ê°œìˆ˜ê°€ 0ê°œì¼ ë•Œ
        const zeroText = document.createElement('p');
        zeroText.innerText = "0ê°œì…ë‹ˆë‹¤!";
        zeroText.className = 'zero-text';
        imageContainer.appendChild(zeroText);
    } 
    else {
        // ë¬¶ìŒì˜ ê°œìˆ˜ë§Œí¼ ë°˜ë³µí•˜ì—¬ ê° ë¬¶ìŒ divë¥¼ ìƒì„±
        for (let i = 0; i < numberOfGroups; i++) {
            const groupDiv = document.createElement('div');
            groupDiv.className = 'image-group'; // ë¬¶ìŒ êµ¬ë¶„ì„ ìœ„í•œ í´ë˜ìŠ¤

            // ë¬¶ìŒ ì´ë¯¸ì§€ (fruitX.png ë˜ëŠ” fruitX.jpg)ë¥¼ í•œ ë²ˆë§Œ ì¶”ê°€
            const img = document.createElement('img');
            img.src = imagePath; // ì„ íƒëœ ë¬¶ìŒ ë‹¨ìœ„ì— ë§ëŠ” ê³¼ì¼ ì´ë¯¸ì§€ ì‚¬ìš©
            img.alt = `${groupingUnit}ê°œ ë¬¶ìŒ`; // alt í…ìŠ¤íŠ¸ë„ ë¬¶ìŒ ì •ë³´ í¬í•¨
            groupDiv.appendChild(img);
            
            imageContainer.appendChild(groupDiv);
        }
    }

    countingPopupOverlay.style.display = 'flex'; // ê·¸ë¦¼ íŒì—…ì°½ í‘œì‹œ

    // ì…ë ¥ í•„ë“œ ë‹¤ì‹œ í‘œì‹œ
    totalCountLabel.style.display = 'block';
    totalCountAnswerInput.style.display = 'block';
    equationLabel.style.display = 'block';
    equationAnswerInput.style.display = 'block';

    // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
    totalCountAnswerInput.value = "";
    equationAnswerInput.value = "";
    totalCountAnswerInput.focus(); // ì²« ë²ˆì§¸ ì…ë ¥ì°½ì— í¬ì»¤ìŠ¤
}

// 5. ê·¸ë¦¼ íŒì—…ì°½ ë‹«ê¸°
function hideCountingPopup() {
    countingPopupOverlay.style.display = 'none';
}

// 6. ì •ë‹µ í™•ì¸ (checkAnswer í•¨ìˆ˜ ìˆ˜ì •)
function checkAnswer() {
    const userAnswerCount = parseInt(totalCountAnswerInput.value);
    const userAnswerEquation = equationAnswerInput.value.trim(); // ê³µë°± ì œê±°

    let isCountCorrect = false;
    let isEquationCorrect = false;

    // 1) ì´ ê°œìˆ˜ í™•ì¸
    if (isNaN(userAnswerCount) || userAnswerCount < 0 || userAnswerCount > 81) { // 9*9=81ê¹Œì§€ í—ˆìš©
        resultDisplay.innerText = "â— ì´ ê°œìˆ˜ëŠ” 0~81 ì‚¬ì´ì˜ ìˆ«ìë¡œ ì…ë ¥í•´ ì£¼ì„¸ìš”!";
        playWrongSound();
        return;
    }
    if (userAnswerCount === correctTotalCount) {
        isCountCorrect = true;
    }

    // 2) ê³±ì…ˆì‹ í™•ì¸ (ì˜ˆ: 1x7=7)
    // ì˜¬ë°”ë¥¸ ê³±ì…ˆì‹ ì˜ˆì‹œ: "ë¬¶ì–´ì„¸ê¸°ë‹¨ìœ„ x ë¬¶ìŒê°œìˆ˜ = ì´ê°œìˆ˜"
    const correctEquation = `${groupingUnit}x${numberOfGroups}=${correctTotalCount}`;

    if (userAnswerEquation === correctEquation) {
        isEquationCorrect = true;
    } else {
        // ìœ ì—°í•œ ê²€ì¦ (ì˜ˆ: 1*7=7, 1* 7 = 7 ë“±)
        const simplifiedUserEquation = userAnswerEquation.replace(/\s/g, '').replace(/\*/g, 'x'); // ê³µë°± ì œê±°, *ë¥¼ xë¡œ í†µì¼
        if (simplifiedUserEquation === correctEquation) {
            isEquationCorrect = true;
        }
    }

    // ê²°ê³¼ ì¶œë ¥
    if (isCountCorrect && isEquationCorrect) {
        resultDisplay.innerText = "ğŸ‰ ì •ë‹µì´ì—ìš”! ì•„ì£¼ ì˜í–ˆì–´ìš”!";
        playCorrectSound();
    } else if (isCountCorrect && !isEquationCorrect) {
        resultDisplay.innerText = `ğŸ˜¢ ì´ ê°œìˆ˜ëŠ” ë§ì•˜ì§€ë§Œ, ê³±ì…ˆì‹ì´ í‹€ë ¸ì–´ìš”! ì •ë‹µ ê³±ì…ˆì‹ì€ ${correctEquation} ì…ë‹ˆë‹¤.`;
        playWrongSound();
    } else if (!isCountCorrect && isEquationCorrect) {
        resultDisplay.innerText = `ğŸ˜¢ ê³±ì…ˆì‹ì€ ë§ì•˜ì§€ë§Œ, ì´ ê°œìˆ˜ê°€ í‹€ë ¸ì–´ìš”! ì •ë‹µì€ ${correctTotalCount} ê°œ ì…ë‹ˆë‹¤.`;
        playWrongSound();
    }
    else {
        resultDisplay.innerText = `ğŸ˜¢ í‹€ë ¸ì–´ìš”! ì •ë‹µì€ ${correctTotalCount} ê°œì´ê³ , ê³±ì…ˆì‹ì€ ${correctEquation} ì…ë‹ˆë‹¤.`;
        playWrongSound();
    }
}

// 7. ì²˜ìŒìœ¼ë¡œ ì´ˆê¸°í™” (resetQuiz í•¨ìˆ˜ ìˆ˜ì •)
function resetQuiz() {
    totalCountAnswerInput.value = "";
    equationAnswerInput.value = "";
    resultDisplay.innerText = "";
    imageContainer.innerHTML = ''; // ê·¸ë¦¼ íŒì—…ì°½ ì´ë¯¸ì§€ ì´ˆê¸°í™”

    hideCountingPopup(); // ê·¸ë¦¼ íŒì—…ì°½ ìˆ¨ê¹€
    hideGroupingOptionPopup(); // ë¬¶ì–´ ì„¸ê¸° ì„ íƒ íŒì—… ìˆ¨ê¹€

    groupingUnit = 0; // ë¬¶ì–´ ì„¸ê¸° ë‹¨ìœ„ ì´ˆê¸°í™”
    numberOfGroups = 0; // ë¬¶ìŒ ê°œìˆ˜ ì´ˆê¸°í™”
    correctTotalCount = 0; // ì´ ê°œìˆ˜ ì´ˆê¸°í™”

    startButton.disabled = true; // ì‹œì‘ ë²„íŠ¼ ë¹„í™œì„±í™”

    // ì…ë ¥ í•„ë“œ ë° ë ˆì´ë¸” ìˆ¨ê¹€
    totalCountLabel.style.display = 'none';
    totalCountAnswerInput.style.display = 'none';
    equationLabel.style.display = 'none';
    equationAnswerInput.style.display = 'none';

    stopSounds(); // ì‚¬ìš´ë“œ ì •ì§€
}

// ì‚¬ìš´ë“œ ì¬ìƒ í•¨ìˆ˜ (ì¤‘ë³µ ì½”ë“œ ë°©ì§€)
function playCorrectSound() {
    correctSound.pause();
    correctSound.currentTime = 0;
    correctSound.play();
}

function playWrongSound() {
    wrongSound.pause();
    wrongSound.currentTime = 0;
    wrongSound.play();
}

function stopSounds() {
    correctSound.pause();
    correctSound.currentTime = 0;
    wrongSound.pause();
    wrongSound.currentTime = 0;
}

// ì´ˆê¸° ë¡œë“œ ì‹œ ëª¨ë“  ìƒíƒœë¥¼ ì´ˆê¸°í™”
window.onload = function() {
    resetQuiz();
};

// ì…ë ¥ í•„ë“œì™€ ê²°ê³¼ì°½ì„ ì´ˆê¸°í™”í•˜ê³  ìˆ¨ê¸°ëŠ” í•¨ìˆ˜ (ì‚¬ìš©ì ì„ íƒ í›„ ë°”ë¡œ ì´ˆê¸°í™” ìœ„í•¨)
function resetInputsAndResult() {
    totalCountAnswerInput.value = "";
    equationAnswerInput.value = "";
    resultDisplay.innerText = "";
    totalCountLabel.style.display = 'none';
    totalCountAnswerInput.style.display = 'none';
    equationLabel.style.display = 'none';
    equationAnswerInput.style.display = 'none';
}
</script>
</body>
</html>
 